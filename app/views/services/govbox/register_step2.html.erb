<div class="container">
  <%= form_tag register_step3_services_govbox_index_path do %>
    <%= render 'hidden_fields_from_step1' %>

    <div class="row">
      <div class="col-lg-8">
        <h1 class="form-title">Údaje štatutára</h1>
        <p class="form-subtitle lead">Zadajte údaje štatutára (napríklad konateľa s.r.o.), ktorý podpíše splnomocnenie na prístup k schránke.</p>

        <% if @statutory_entries %>
          <h6 style="margin: 30px 0;">Vyberte štatutára zo zoznamu:</h6>
          <div class="row">
            <div class="col-md-12">
              <% @statutory_entries.each_with_index do |person, index| %>
                <label class="form-check-label" style="margin: 8px 0;">
                  <%= radio_button_tag :statutory_entry, index, false, class: 'form-check-input', data: { given_name: person[:first_name], family_name: person[:last_name], person_formatted_address: format_address(person) } %>
                  <span><%= "#{person[:first_name]} #{person[:last_name]}, #{format_address(person)}" %></span>
                </label>
              <% end %>
            </div>
          </div>
          <h6 style="margin: 30px 0;">
            <a href="#" data-toggle="collapse" data-target="#form-input-fields">alebo kliknite sem a zadajte údaje ručne</a>
          </h6>

          <script>
            $('input:radio').change(e => {
              let selected = e.target.dataset;
              $('#given_name').val(selected.givenName);
              $('#family_name').val(selected.familyName);
              $('#person_formatted_address').val(selected.personFormattedAddress);
            });

            $(document).ready(function () {
              $("#form-input-fields").addClass('collapse hide');
            });
          </script>
        <% end %>

        <div id="form-input-fields">
          <div class="row">
            <div class="col-md-4 form-group">
              <%= label_tag :given_name, 'Meno' %>
              <%= text_field_tag :given_name, params[:given_name], class: 'form-control input-lg', required: true %>
            </div>
            <div class="col-md-5 form-group">
              <%= label_tag :family_name, 'Priezvisko' %>
              <%= text_field_tag :family_name, params[:family_name], class: 'form-control input-lg', required: true %>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12 form-group">
              <%= label_tag :person_formatted_address, 'Trvalé bydlisko' %>
              <%= text_field_tag :person_formatted_address, params[:person_formatted_address], class: 'form-control input-lg', required: true %>
              <span class="form-text text-muted">Napríklad: Koprivnická 9/B, 841 04 Bratislava</span>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <p class="form-text text-muted mt-3">
              <strong>Poznámka:</strong> Ak za právnickú osobu podpísujú viacerí štatutári naraz, <%= link_to 'kontaktujte nás', 'mailto:podpora@govbox.slovensko.digital' %>.
            </p>
          </div>
        </div>

      </div>
    </div>

    <div class="row form-navigation">
      <div class="col-md-4 form-group">
        <%= button_tag class: 'btn btn-primary btn-lg' do %>
          <strong>Ďalej</strong>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
